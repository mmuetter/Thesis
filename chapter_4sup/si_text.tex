\pagebreak
\section{SI TEXT}

%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%

\subsection{Time weighted net growth rates}\label{ssec:netgrowth}
We define $\psi$ as the linearly time weighted average of the temporal net growth rate $\hat{\psi}$:
\begin{align}
  w(t) &=\frac{2}{T^{2}}(T-t),  \\
  \psi &=  \int_{0}^{T} \hat{\psi}(t)\,w(t)\,dt =
  \frac{2}{T^{2}} \int_{0}^{T} (T - u)\, \hat{\psi}(u)\, du,
  \label{eq:psi_weighted}
\end{align}
where  the kernel \(w(t)\) decreases linearly from \(T\) to \(0\) and is normalised such \(\int_0^T w(t)\,dt=1\).
To derive \(\psi\) from the luminescence trajectories \(I(t) = I_0 e^{\int_{0}^{t}\hat{\psi}(u)\,du}\), we first normalise
\begin{equation}
  y(t)=\frac{I(t)}{I(0)}.
  \label{eq:norm}
\end{equation}

We then define the log-normalised trajectory
\begin{equation}
  Y(t)=\ln y(t)=\ln I(t)-\ln I(0)=\int_{0}^{t}\hat{\psi}(u)\,du,
  \label{eq:Ydef}
\end{equation}
and integrate \(Y(t)\) over time, by applying Fubini's theorem:
\begin{equation}
  \int_{0}^{T} Y(t)\, dt =
  \int_{0}^{T} \left( \int_{0}^{t} \hat{\psi}(u)\, du \right) dt
  =    \int_{0}^{T} (T - u)\, \hat{\psi}(u)\, du,
  \label{eq:intY}
\end{equation}
so that
\begin{equation}
  \psi=\frac{2}{T^{2}}\int_{0}^{T}Y(t)\,dt.
  \label{eq:psi_eff}
\end{equation}

We define the treatment effect as the  time-weighted difference between the temporal net growth rates.
This corresponds to the scaled area between two curves (control and treatment):
\begin{equation}
  \int_{0}^{T}\!\big(Y_{\mathrm{ctrl}}(t)-Y_{\mathrm{treat}}(t)\big)\,dt    =
  \int_{0}^{T}\!(T-t)\,\big(\hat{\psi}_{\mathrm{ctrl}}(t)-\hat{\psi}_{\mathrm{treat}}(t)\big)\,dt,
  \label{eq:intYdiff}
\end{equation}
and is identical to the difference of the time-weighted net growth rates:
\begin{equation}
  \tau =
  \psi_{\mathrm{ctrl}}-\psi_{\mathrm{treat}}
  = \frac{2}{T^{2}}\int_{0}^{T}\!\big(Y_{\mathrm{ctrl}}(t)-Y_{\mathrm{treat}}(t)\big)\,dt.
  \label{eq:tau_eff}
\end{equation}

\begin{mdframed}[linewidth=0.8pt,backgroundcolor=gray!5,roundcorner=3pt]
  \textbf{Intuition for \(\psi\) and \(\tau\).}\\

  \emph{Non–monophasic case.}
  If rates vary over time, \(\tau\) represents a time–weighted average of instantaneous rate differences,
  \[
    \tau = 2/T^2 \int_{0}^{T}\!(T-t)\,\big(\hat{\psi}_{\mathrm{ctrl}}(t)-\hat{\psi}_{\mathrm{treat}}(t)\big)\,dt,
  \]
  where the weighting factor \((T-t)\) decreases linearly from \(T\) to \(0\).
  Early rate differences thus contribute more strongly than later ones.
  This weighting is desirable because an early population reduction affects the population for longer than a delayed effect, even if both trajectories reach the same endpoint.

  \medskip

  \emph{Constant–rate case.}
  If the temporal net growth rate  is constant $\hat{\psi}(t) = \hat{\psi}$, \autoref{eq:psi_eff}, the time weighted net growth rate, simplifies to:
  \[\psi = \hat{\psi}.\]
\end{mdframed}

%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%
\pagebreak
\subsection{Quantifying Light Noise}\label{ssec:lightnoise}
We quantified stray light by using a calibration plate in which six source wells (E5, E12, E20, L5, L12, L20) contained \SI{50}{\micro\liter} of luminescent overnight culture. All other wells were empty.
A single luminescence read of all wells yielded raw intensities $\hat I$.
We calculated the ratio of raw light intensities $\hat{I}_{\mathrm{e}}/\hat{I}_{\mathrm{l}}$ between empty wells $e$ and the nearest luminescent culture well $l$ as a function of the distance between their midpoints $d_{el}$ (with diagonal neighbours at a distance $\sqrt{2}$).
For each discrete distance $d_{el}$, we summarised ratios by their median to obtain a kernel $r(d)$ (\autoref{fig:light_distribution}).
We estimate the light contribution from well $l$ into well $e$ as $\hat I_{el}=r(d_{el})\,\hat I_l$.
For each experimental plate and time point, we corrected each well by subtracting received light noise,
\begin{equation}
  I_e=\hat I_e-\sum_l r(d_{el})\,\hat I_l,
  \label{eq:noise_corr}
\end{equation}
where the sum is restricted to wells within $d\le 3$.

%%%
%%% PD
%%%

\subsection{Drug conditions and response functions}
\paragraph{Single-drug pharmacodynamic curves.}
For each drug \(i\) we describe the relationship between concentration \(c\) and net growth rate by the fitted pharmacodynamic curve
\begin{equation}
  f_i(c)
  =
  \psi_{0}
  -
  \frac{(\psi_{0}-\psi_{\min,i})(c/z_{\mathrm{MIC},i})^{\kappa_i}}
  {(c/z_{\mathrm{MIC},i})^{\kappa_i}-(\psi_{\min,i}/\psi_{0})},
  \qquad
  [0,\infty)\rightarrow[\psi_{\min,i},\psi_{0}].
  \label{eq:single_drug_pd_si}
\end{equation}

\paragraph{Closed-form inversion.}
Using \autoref{eq:single_drug_pd_si}, the inverse \(f_i^{-1}\) can be written in closed form as
\begin{equation}
  f_i^{-1}(\psi)
  =
  z_{\mathrm{MIC},i}
  \left(
    \frac{\bigl(\psi_0-\psi\bigr)\,\psi_{\min,i}/\psi_0}
    {\bigl(\psi_0-\psi\bigr)-\bigl(\psi_0-\psi_{\min,i}\bigr)}
  \right)^{1/\kappa_i},
  \qquad
  \psi\in[\psi_{\min,i},\psi_0].
  \label{eq:psi_inverse_closed_form}
\end{equation}

\paragraph{Cartesian conditions.}
A \emph{condition} is defined by a set of drug concentrations \(\{c_i\}\), with drug \(i \in \{\mathrm{AMO},\mathrm{CHL},\mathrm{COL},\mathrm{PEN},\mathrm{POL},\mathrm{TET}\}\).
The control condition corresponds to \(\{c_i = 0\ \forall i\}\) and is denoted by \(\emptyset\).

Throughout this work, quantities ($X$) characterising a treatment condition are written as functions of the underlying condition  \(X(\{c_i\})\) .
For brevity, we write \(X(c_A)\) when only one drug is present, \(X(c_A,c_B)\) when two drugs are present, and \(X(\emptyset)\) if no drug is present (control).

\paragraph{Polar pharmacodynamic curves.}
For two-drug combinations, conditions are parameterized in polar coordinates \((z,\phi)\), and the corresponding effective growth rate is written as
\begin{equation}
  g(z,\phi) =
  \psi_{0} -
  \frac{\bigl(\psi_{0}-\psi_{\min}(\phi)\bigr)\,\bigl(z/z_{\mathrm{MIC}}(\phi)\bigr)^{\kappa(\phi)}}
  {\bigl(z/z_{\mathrm{MIC}}(\phi)\bigr)^{\kappa(\phi)}-\psi_{\min}(\phi)/\psi_{0}}.
  \label{eq:polar_pd}
\end{equation}

%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%
\subsection{Bliss independence}\label{ssec:bliss}
Bliss independence is defined by assuming that the probabilities of a cell being killed by drugs \(A\) and \(B\) within a fixed observation window are statistically independent \cite{Bliss1939}.
Under this assumption,
\begin{equation}
  p_{AB}^\mathrm{Bliss}=p_A+p_B-p_A\,p_B,
  \label{eq:bliss_prob}
\end{equation}
where \(p_A\) and \(p_B\) denote the single–drug kill probabilities within \(T\).

\paragraph{Time--varying hazards.}
Let \(\hat{\tau}_i(t)\ge 0\) denote a time--dependent kill hazard under treatment \(i\).
The survival fraction at time \(T\) is \(S_i(T)=\exp\!\big(-\int_0^T\hat{\tau}_i(u)\,du\big)\).
Bliss independence implies multiplicative survival \(S_{AB}(T)=S_A(T)\,S_B(T)\), hence additive cumulative hazards:
\begin{equation}
  \int_0^T \hat{\tau}_{AB}^\mathrm{Bliss}(u)\,du=\int_0^T \hat{\tau}_A(u)\,du+\int_0^T \hat{\tau}_B(u)\,du.
  \label{eq:hazard_additivity}
\end{equation}
To connect this survival formulation to the growth-based log-trajectories, we interpret the instantaneous treatment effect as the reduction in temporal net growth relative to the untreated control, i.e.\ \(\hat{\tau}_i(t)=\hat{\psi}_{\mathrm{ctrl}}(t)-\hat{\psi}_i(t)\).
Substituting  \(Y_i(t)=\int_{0}^{t}\hat{\psi}_i(u)\,du\) (\autoref{eq:Ydef}), it follows that:
\[
  Y_i(t)=Y_{\mathrm{ctrl}}(t)-\int_0^t \hat{\tau}_i(u)\,du.
\]
Using additive cumulative hazards under Bliss then yields
\begin{equation}
  Y_{AB}^\mathrm{Bliss}(t)=Y_{A}(t)+Y_{B}(t)-Y_{\mathrm{ctrl}}(t).
  \label{eq:Y_additivity}
\end{equation}

Integrating \autoref{eq:Y_additivity} over time yields the Bliss prediction for the effective treatment effect:
\begin{equation}
  \tau^{\mathrm{Bliss}}(c_A,c_B)
  =
  \tau(c_A)
  +
  \tau(c_B).
  \label{eq:tau_eff_bliss}
\end{equation}

\paragraph{Bliss-based interaction score \(\mu\).}
Based on the Bliss expectation for a combination at concentrations \((c_A,c_B)\), we define the interaction score as the normalised divergence from the expectation:
\begin{equation}
  \mu(c_A,c_B) =
  \frac{\tau(c_A)+\tau(c_B)-\tau(c_A,c_B)}
  {\mathrm{median}\!\bigl(\tau(c_A)\bigr)+\mathrm{median}\!\bigl(\tau(c_B)\bigr)}.
  \label{eq:mu_si}
\end{equation}

To avoid division by zero, normalisation is performed using the medians of the monotherapy effects.
The score is only evaluated for conditions \((c_A,c_B)\) classified as eligible, defined as those where the combined effect \(\tau(c_A,c_B)\) and at least one of the single-drug effects, \(\tau(c_A)\) or \(\tau(c_B)\), are significant.

\begin{mdframed}[linewidth=0.8pt,backgroundcolor=gray!5,roundcorner=3pt]
  \textbf{Interpreting the bliss interaction score \(\mu\).}\\[3pt]
  Positive values of \(\mu\) indicate synergy (\(\tau(c_A,c_B)>\tau(c_A)+\tau(c_B)\)),
  negative values indicate antagonism, and \(\mu=0\) corresponds to independence.
\end{mdframed}

%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%
\subsection{Loewe additivity}\label{ssec:loewe}
Loewe additivity is a form of dose additivity, formalising self--additivity, i.e.\ that a drug combined with itself should behave like a higher dose of the same drug \cite{Loewe1926}.
This concept is independent of the particular choice of effect measure, provided the effect can be represented on a shared, monotone dose--response scale.
In our case, this effect scale is the effective net growth rate \(\psi\) (see \autoref{eq:psi_eff}).

For a combination with the observed effect \(\psi(c_A,c_B)\), Loewe additivity requires that the fractions of the equivalent single-drug concentrations sum to one,
\begin{equation}
  \frac{c_A}{f_A^{-1}\!\big(\psi(c_A,c_B)\big)} +
  \frac{c_B}{f_B^{-1}\!\big(\psi(c_A,c_B)\big)} = 1,
  \label{eq:loewe_core_si}
\end{equation}
where \(f_A\) and \(f_B\) are the pharmacodynamic curves mapping concentrations to \(\psi\), and \(f_A^{-1}\) and \(f_B^{-1}\) map an effect level \(\psi\) to the corresponding equivalent single-drug concentration.
For the well-based interaction analysis, we use the fitted pharmacodynamic curve (\autoref{eq:single_drug_pd_si}) as the pharmacodynamic function \(f_i\), whereas for the surface-based analysis, we infer \(f_i\) from the single-drug edge profiles of the checkerboard surface splines.
The Loewe prediction \(\psi_{\mathrm{Loewe}}(c_A,c_B)\) is obtained by numerically solving \autoref{eq:loewe_core} for \(\psi\).

\paragraph{Loewe interaction score (\(\nu\)).}
We quantify deviations from Loewe additivity using:
\begin{equation}
  \nu(c_A,c_B) =
  \frac{c_A}{f_A^{-1}\!\big(\psi(c_A,c_B)\big)} +
  \frac{c_B}{f_B^{-1}\!\big(\psi(c_A,c_B)\big)} -1.
  \label{eq:fici_si}
\end{equation}

Because \(f_A^{-1}\) and \(f_B^{-1}\) are only defined on \(\mathrm{Im}(f_A)=[\psi_{\min,A},\psi_{0}]\) and \(\mathrm{Im}(f_B)=[\psi_{\min,B},\psi_{0}]\), \(\nu\) is only defined if
\begin{equation}
  \psi(c_A,c_B)\in \mathrm{Im}(f_A)\cap \mathrm{Im}(f_B)=[\max(\psi_{\min,A},\psi_{\min,B}),\,\psi_{0}].
  \label{eq:loewe_domain}
\end{equation}

The score is only evaluated for conditions \((c_A,c_B)\) classified as eligible, defined as those where the combined effect \(\tau(c_A,c_B)\) and at least one of the single-drug effects, \(\tau(c_A)\) or \(\tau(c_B)\), are significant.

\begin{mdframed}[linewidth=0.8pt,backgroundcolor=gray!5,roundcorner=3pt]
  \textbf{Interpreting the Loewe interaction score \(\nu\).}\\[3pt]
  By construction \(\nu=0\) corresponds to Loewe additivity, \(\nu<0\) indicates synergy, and \(\nu>0\) indicates antagonism.\\
  Because Loewe additivity requires equivalent single-drug concentrations for both drugs at the observed effect level, \(\nu\) can only be evaluated when \(\psi(c_A,c_B)\) lies in the overlap of the two single-drug effect ranges, i.e.\ \(\psi\ge \max(\psi_{\min,A},\psi_{\min,B})\).
\end{mdframed}

\clearpage
\subsection{Peptide--antibiotic interaction model}\label{ssec:toy_model}
We consider two drugs, \(A\) and \(B\), acting on a population with a size trajectory \(x(t)\).
Drug~\(A\) represents a peptide-like effect that causes an instantaneous multiplicative reduction in population size by a factor \(\alpha\in(0,1]\), whereas drug~\(B\) represents a conventional antibiotic that changes the subsequent net growth rate but does not cause an initial drop.
We assume that the combination of two drugs induces a sharp drop by the factor $\alpha$ followed by net growth, determined by drug B:
\begin{align}
  x_{\mathrm{ctrl}}(t) &= x_0\,\exp\!\big(\hat{\psi}_{\mathrm{ctrl}}\,t\big), \notag\\
  x_{B}(t) &= x_0\,\exp\!\big(\hat{\psi}_{B}\,t\big), \notag\\
  x_{A}(t) &= \alpha\,x_{\mathrm{ctrl}}(t), \notag\\
  x_{AB}(t) &= \alpha\,x_{B}(t), \notag
\end{align}
and:
\begin{align}
  Y_{\mathrm{ctrl}}(t) &= \ln x_0+\hat{\psi}_{\mathrm{ctrl}}\,t, \notag\\
  Y_{B}(t) &= \ln x_0+\hat{\psi}_{B}\,t, \notag\\
  Y_{A}(t) &= Y_{\mathrm{ctrl}}(t)+\ln \alpha, \notag\\
  Y_{AB}(t) &= Y_{B}(t)+\ln \alpha. \notag
\end{align}

Using the definition of effective-rate \(\tau_i=\frac{2}{T^2}\int_0^T\!\big(Y_{\mathrm{ctrl}}(t)-Y_i(t)\big)\,dt\), we obtain the following.
\[
  \tau_A=\frac{2}{T^2}\int_0^T\!(-\ln\alpha)\,dt, \qquad
  \tau_B=\frac{2}{T^2}\int_0^T\!\bigl(\hat{\psi}_{\mathrm{ctrl}}-\hat{\psi}_B\bigr)t\,dt,
\]
and
\begin{equation}
  \tau_{AB} =
  \frac{2}{T^2}\int_0^T\!\Bigl(\bigl(\hat{\psi}_{\mathrm{ctrl}}-\hat{\psi}_B\bigr)t-\ln\alpha\Bigr)\,dt.
  \label{eq:combined_pep}
\end{equation}
Separating the two terms in \autoref{eq:combined_pep} yields
\begin{equation}
  \tau_{AB}=\tau_A+\tau_B,
  \label{eq:toy_model}
\end{equation}
which matches the Bliss expectation for the combined treatment effect.

\subsection{Condition-wise interaction inference on the checkerboard}\label{ssec:bootstrap_interactions}
Each condition \(\{c_i\}\) is realised by a pool of biological replicate wells \(\mathcal{W}(c_A, c_B)\), from which effective growth rates are inferred, as described above.
Treatment effects are estimated by bootstrap resampling from the pools of replicate wells.
We draw \(B=200\) pairs consisting of one control well and one condition well, sampled with replacement from \(\mathcal{W}(\emptyset)\) and \(\mathcal{W}(c_A,c_B)\), respectively.
For each draw \(b\), the treatment effect is defined as
\[
  \tau_b(c_A,c_B) =
  \psi_b(\emptyset)-\psi_b(c_A,c_B),
\]
yielding a bootstrap distribution of treatment effects.

For combination conditions, the corresponding single-drug  growth rates \(\psi_b(c_A,0)\) and \(\psi_b(0,c_B)\) are sampled simultaniously  and included in each bootstrap draw, as they are required for interaction analysis.

\paragraph{Regime-wise aggregation across checkerboard conditions.}
To summarise interactions for a given drug pair within a regime (sub-inhibitory or inhibitory), we combine the condition-wise bootstrap interaction estimates from all eligible checkerboard cells.
For each regime, we sampled 200 eligible conditions with replacement, using sampling probabilities proportional to
\begin{equation}
  w(\phi)=\sin(2\phi).
  \label{eq:weights}
\end{equation}
This excludes single-drug checkerboard edges and gives the highest weight to near-equal mixing.
For every sampled condition, we draw one interaction score from its condition-wise bootstrap distribution.
Repeating this procedure yields an aggregated distribution, from which we report the median and central \(95\%\) interval for the regime-level interaction estimate.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\clearpage
\subsection{Continuous interaction surfaces and geometric exploration}\label{ssec:surface}

\paragraph{Density-based restriction of the surface domain.}
For some drugs, the empirical data density decreases at high concentrations as trajectories drop below the detection limit and are excluded.
We therefore restrict the checkerboard to the high-density subdomain.
For each drug pair, we compute, for every grid cell \((i,j)\), the valid fraction \(f(i,j)=n_{\mathrm{valid}}(i,j)/4\) (with \(n_{\mathrm{valid}}\) counting non-\(\mathrm{NaN}\) values of \(\psi\)).
We then fit a monotone-decreasing helper surface \(f_{\mathrm{dens}}(i,j)\) by alternating one-dimensional isotonic regression sweeps (\texttt{sklearn.isotonic.IsotonicRegression}) along both index axes, followed by bivariate spline interpolation on the \((i,j)\) grid (\texttt{scipy.interpolate.RectBivariateSpline}).
Cells with \(f_{\mathrm{dens}}(i,j)<f_{\min}\) are excluded, and all subsequent bootstrap resampling and surface-spline fitting are performed only on the remaining cells.

\paragraph{Bootstrap datasets and coordinate transform.}
For each pair of drugs \((A,B)\) we first collect all wells belonging to that pair together with their estimated effective net growth rates \(\psi\).
Each well is indexed by a normalised concentration pair  \((z_A, z_B)\).
To stabilise interpolation near zero, we transform the axes to \(\mathrm{Z}_A=\log_2(z_A+1)\) and \(\mathrm{Z}_B=\log_2(z_B+1)\).
For each bootstrap draw \(b\) we generate a resampled surface dataset by sampling, with replacement, one well for every occupied grid point, and retaining its triplet \((\mathrm{Z}_A,\mathrm{Z}_B,\psi)\).

\paragraph{Monotone surface construction.}
For each bootstrap dataset we enforce a monotone-decreasing \(\psi\)-surface by alternating one-dimensional isotonic regressions along rows and columns.
This is important to ensure that the backtransformation $z_\phi(\psi)$ is unique.
Specifically, for each column and then for each row we apply an isotonic regression with a nonincreasing constraint using \texttt{sklearn.isotonic.IsotonicRegression} \cite{Pedregosa2011}.
On each monotone grid we fit a bivariate spline \(s_{AB}^{(b)}(\mathrm{Z}_A,\mathrm{Z}_B)\) using \texttt{scipy.interpolate.RectBivariateSpline} with a linear basis functions in both directions.
For each drug combination we calculate a consensus surface $\psi^\mathrm{cons}$ based on the median of the single splines.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%% vi
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Single-drug inoculum effect analysis}\label{ssec:inoculum}
During data analysis, we noted that inocula varied more than expected, which we traced to variability induced by the pintool.
Across all wells, the pre-treatment luminescence mean was (\(\langle I_0\rangle=4.61\times 10^{4}\,\mathrm{RLU}\)) and the standard deviation was (\(\sigma(I_0)=6.89\times 10^{4}\,\mathrm{RLU}\)), between experiments (\(\sigma_{\mathrm{between}}=4.33\times 10^{4}\,\mathrm{RLU}\)) and within experiments (\(\sigma_{\mathrm{within}}=5.47\times 10^{4}\,\mathrm{RLU}\)).
To investigate whether the observed net growth rates $\psi$ systematically depended on inoculum size, we used the pre-treatment luminescence signal ($I_0$) as a proxy for initial cell density.

For all single-drug  conditions, we fitted an ordinary least-squares regression of \(\psi\) on \(I_0\) to obtain a concentration-specific slope \(\beta_{\mathrm{inoculum}}(c_i)\) together with a confidence interval, the value \(p\) and the determination coefficient \(R^2\).
These slopes and their uncertainty summaries were visualised as concentration--slope profiles with \(95\%\) intervals in \autoref{fig:inoculum}.
Across AMO, CHL, PEN, and TET, the estimated slopes were negligible across concentrations, whereas COL and POL showed the strongest dependence on $I_0$ at intermediate concentrations (around \SI{1}{\micro\gram\per\milli\liter}).

To assess whether inoculum size varies systematically along the one-dimensional concentration index, we pooled all single-drug wells and mapped each well to its concentration index.
We then performed a permutation test  by permuting the light intensity across the concentration indices to obtain a null distribution.
We found no evidence for a systematic trend of inoculum size with index in our data ($p=0.092$), suggesting that inoculum variation contributes noise but does not introduce a strong directional bias along the concentration series.
Consistent with this, the inoculum effect primarily adds scatter at intermediate concentrations of COL and POL, contributing to the increased spread in the corresponding single-drug PD curves.
